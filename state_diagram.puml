@startuml
[*] --> INIT : power_on()
INIT : on_entry
INIT : \tAll indicators on
INIT : \tOPEN_DOOR=T
INIT : \tTIMER=5
INIT: on_exit
INIT --> IDLE_AT_FLOOR2 : timer_expired()


IDLE_AT_FLOOR2 : on_entry
IDLE_AT_FLOOR2 : \tGO_UP=F
IDLE_AT_FLOOR2 : \tGO_DOWN=F
IDLE_AT_FLOOR2 : \tOPEN_DOOR=F
IDLE_AT_FLOOR2 : \tCLOSE_DOOR=T
IDLE_AT_FLOOR2 : \tPOS_FLOOR_2=T
IDLE_AT_FLOOR2 : \tCAB_POS_FLOOR_2=T
IDLE_AT_FLOOR2 : on_exit
IDLE_AT_FLOOR2 --> FLOOR2 : REQ_FLOOR_2()
IDLE_AT_FLOOR2 --> FLOOR2 : REQ_DOOR_OPEN()
IDLE_AT_FLOOR2 --> FLOOR2 : CALL_FLOOR_2()
IDLE_AT_FLOOR2 --> GOINGUPTO3 : CALL_FLOOR_3()
IDLE_AT_FLOOR2 --> GOINGUPTO4 : CALL_FLOOR_4()
IDLE_AT_FLOOR2 --> GOINGUPTO3 : REQ_FLOOR_3()
IDLE_AT_FLOOR2 --> GOINGUPTO4 : REQ_FLOOR_4()

FLOOR2 : on_entry
FLOOR2 : \tOPEN_DOOR=T
FLOOR2 : \tTIMER=5
FLOOR2 : \tPOS_FLOOR_2=T
FLOOR2 : \tCAB_POS_FLOOR_2=T
FLOOR2 : \tAll other indicators off
FLOOR2 : on_exit
FLOOR2 --> IDLE_AT_FLOOR2 : TIMER_EXPIRED()

SENSOR_2_5 : on_entry
SENSOR_2_5 : \tCAB_POS_3=0
SENSOR_2_5 : \tCAB_POS_2.5=T
SENSOR_2_5 : \tCAB_POS_2=0
SENSOR_2_5 : on_exit
SENSOR_2_5 --> FLOOR3 : CAB_POSITION_FLOOR_3()
SENSOR_2_5 --> FLOOR2 : CAB_POSITION_FLOOR_2()

SENSOR_3_5 : on_entry
SENSOR_3_5 : \tCAB_POS_4=0
SENSOR_3_5 : \tCAB_POS_3.5=T
SENSOR_3_5 : \tCAB_POS_3=0
SENSOR_3_5 : on_exit
SENSOR_3_5 --> FLOOR4 : CAB_POSITION_FLOOR_4()
SENSOR_3_5 --> FLOOR3 : CAB_POSITION_FLOOR_3()


IDLE_AT_FLOOR3 : on_entry
IDLE_AT_FLOOR3 : \tGO_UP=F
IDLE_AT_FLOOR3 : \tGO_DOWN=F
IDLE_AT_FLOOR3 : \tOPEN_DOOR=F
IDLE_AT_FLOOR3 : \tCLOSE_DOOR=T
IDLE_AT_FLOOR3 : \tCAB_POS_3=T
IDLE_AT_FLOOR3 : \tPOS_FLOOR_3=T
IDLE_AT_FLOOR3 : on_exit
IDLE_AT_FLOOR3 --> FLOOR3 : REQ_FLOOR_3()
IDLE_AT_FLOOR3 --> FLOOR3 : REQ_DOOR_OPEN()
IDLE_AT_FLOOR3 --> FLOOR3 : CALL_FLOOR_3()
IDLE_AT_FLOOR3 --> GOINGUPTO4 : CALL_FLOOR_4()
IDLE_AT_FLOOR3 --> GOINGDNTO2 : CALL_FLOOR_2()
IDLE_AT_FLOOR3 --> GOINGUPTO4 : REQ_FLOOR_4()
IDLE_AT_FLOOR3 --> GOINGDNTO2 : REQ_FLOOR_2()

FLOOR3 : on_entry
FLOOR3 : \tOPEN_DOOR=T
FLOOR3 : \tTIMER=5
FLOOR3 : \tCAB_POS_3=T
FLOOR3 : \tPOS_FLOOR_3=T
FLOOR3 : \tAll other indicators off
FLOOR3 : on_exit
FLOOR3 --> IDLE_AT_FLOOR3 : TIMER_EXPIRED()


IDLE_AT_FLOOR4 : on_entry
IDLE_AT_FLOOR4 : \tGO_UP=F
IDLE_AT_FLOOR4 : \tGO_DOWN=F
IDLE_AT_FLOOR4 : \tOPEN_DOOR=F
IDLE_AT_FLOOR4 : \tCLOSE_DOOR=T
IDLE_AT_FLOOR4 : \tCAB_POS_4=T
IDLE_AT_FLOOR4 : \tPOS_FLOOR_4=T
IDLE_AT_FLOOR4 : on_exit
IDLE_AT_FLOOR4 --> FLOOR4 : REQ_FLOOR_4()
IDLE_AT_FLOOR4 --> FLOOR4 : REQ_DOOR_OPEN()
IDLE_AT_FLOOR4 --> FLOOR4 : CALL_FLOOR_4()
IDLE_AT_FLOOR4 --> GOINGDNTO2 : CALL_FLOOR_2()
IDLE_AT_FLOOR4 --> GOINGDNTO3 : CALL_FLOOR_3()
IDLE_AT_FLOOR4 --> GOINGDNTO2 : REQ_FLOOR_2()
IDLE_AT_FLOOR4 --> GOINGDNTO3 : REQ_FLOOR_3()

FLOOR4 : on_entry
FLOOR4 : \tOPEN_DOOR=T
FLOOR4 : \tTIMER=5
FLOOR4 : \tCAB_POS_4=T
FLOOR4 : \tPOS_FLOOR_4=T
FLOOR4 : \tAll other indicators off
FLOOR4 : on_exit
FLOOR4 --> IDLE_AT_FLOOR4 : TIMER_EXPIRED()


GOINGUPTO3 : on_entry
GOINGUPTO3 :\tGO_UP=T
GOINGUPTO3 :\tGO_DOWN=F
GOINGUPTO3 :\tOPEN_DOOR=F
GOINGUPTO3 :\tCLOSE_DOOR=F
GOINGUPTO3 :\tREQ_FLOOR_ACCEPTED_2=T
GOINGUPTO3 :\tCALL_ACCEPTED_FLOOR_2=T
GOINGUPTO3 :\tUPPTAGEN_FLOOR_3=T
GOINGUPTO3 :\tUPPTAGEN_FLOOR_4=T
GOINGUPTO3 : on_exit
GOINGUPTO3 --> SENSOR_2_5 : CAB_POSITION_FLOOR_2.5()

GOINGUPTO4 : on_entry
GOINGUPTO4 :\tGO_UP=T
GOINGUPTO4 :\tGO_DOWN=F
GOINGUPTO4 :\tOPEN_DOOR=F
GOINGUPTO4 :\tCLOSE_DOOR=F
GOINGUPTO4 :\tREQ_FLOOR_ACCEPTED_4=T
GOINGUPTO4 :\tCALL_ACCEPTED_FLOOR_4=T
GOINGUPTO4 :\tUPPTAGEN_FLOOR_2=T
GOINGUPTO4 :\tUPPTAGEN_FLOOR_3=T
GOINGUPTO4 : on_exit
GOINGUPTO4 --> SENSOR_3_5 : CAB_POSITION_FLOOR_3.5()

GOINGDNTO3 : on_entry
GOINGDNTO3 :\tGO_UP=F
GOINGDNTO3 :\tGO_DOWN=T
GOINGDNTO3 :\tOPEN_DOOR=F
GOINGDNTO3 :\tCLOSE_DOOR=F
GOINGDNTO3 :\tREQ_FLOOR_ACCEPTED_3=T
GOINGDNTO3 :\tCALL_ACCEPTED_FLOOR_3=T
GOINGDNTO3 :\tUPPTAGEN_FLOOR_2=T
GOINGDNTO3 :\tUPPTAGEN_FLOOR_4=T
GOINGDNTO3 : on_exit
GOINGDNTO3 --> SENSOR_3_5 : CAB_POSITION_FLOOR_3.5()

GOINGDNTO2 : on_entry
GOINGDNTO2 :\tGO_UP=F
GOINGDNTO2 :\tGO_DOWN=T
GOINGDNTO2 :\tOPEN_DOOR=F
GOINGDNTO2 :\tCLOSE_DOOR=F
GOINGDNTO2 :\tREQ_FLOOR_ACCEPTED_2=T
GOINGDNTO2 :\tCALL_ACCEPTED_FLOOR_2=T
GOINGDNTO2 :\tUPPTAGEN_FLOOR_3=T
GOINGDNTO2 :\tUPPTAGEN_FLOOR_4=T
GOINGDNTO2 : on_exit
GOINGDNTO2 --> SENSOR_2_5 : CAB_POSITION_FLOOR_2.5()


@enduml
